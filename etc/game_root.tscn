[gd_scene load_steps=7 format=2]

[ext_resource path="res://hud_elements/curtains.tscn" type="PackedScene" id=1]
[ext_resource path="res://etc/game_root.gd" type="Script" id=2]
[ext_resource path="res://hud_elements/pause_root.tscn" type="PackedScene" id=3]
[ext_resource path="res://fonts/tex_gyre_heros/tex_gyre_logotype.tres" type="DynamicFont" id=4]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;
render_mode blend_mix;

// Copypasted from:
// https://gist.github.com/patriciogonzalezvivo/670c22f3966e662d2f83

float rand(vec2 n) { 
	return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);
}

float noise(vec2 p){
	vec2 ip = floor(p);
	vec2 u = fract(p);
	u = u*u*(3.0-2.0*u);
	
	float res = mix(
		mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),
		mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);
	return res*res;
}


void fragment() {
	vec2 offset = UV + ((noise(UV + vec2(TIME * 100.0, TIME * 100.0 + 0.01) * 100.0) - vec2(0.5, 0.5)) * 0.001);
	COLOR = texture(TEXTURE, offset); 
}"

[sub_resource type="ShaderMaterial" id=2]
shader = SubResource( 1 )

[node name="game_root" type="Control" groups=["listen_for_player_death", "listen_for_stage_complete", "listen_for_title"]]
pause_mode = 2
anchor_right = 1.0
anchor_bottom = 1.0
script = ExtResource( 2 )

[node name="ViewportContainer" type="ViewportContainer" parent="."]
margin_right = 1920.0
margin_bottom = 1080.0

[node name="Viewport" type="Viewport" parent="ViewportContainer"]
pause_mode = 1
size = Vector2( 1920, 1080 )
handle_input_locally = false
render_target_update_mode = 3
audio_listener_enable_2d = true
audio_listener_enable_3d = true

[node name="Title Cover" type="Control" parent="."]
margin_right = 1920.0
margin_bottom = 1080.0

[node name="Label" type="Label" parent="Title Cover"]
material = SubResource( 2 )
margin_right = 1920.0
margin_bottom = 1080.0
custom_colors/font_color = Color( 1, 1, 1, 1 )
custom_fonts/font = ExtResource( 4 )
text = "the time has
come"
align = 1
valign = 1
uppercase = true

[node name="curtains" parent="." instance=ExtResource( 1 )]

[node name="pause_root" parent="." instance=ExtResource( 3 )]
